<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="622px" preserveAspectRatio="none" style="width:580px;height:622px;" version="1.1" viewBox="0 0 580 622" width="580px" zoomAndPan="magnify"><defs><filter height="300%" id="f9m3ai9wptbzw" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="50.5" x2="50.5" y1="72.8906" y2="539.4141"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="226.5" x2="226.5" y1="72.8906" y2="539.4141"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="402.5" x2="402.5" y1="72.8906" y2="539.4141"/><rect fill="#FEFECE" filter="url(#f9m3ai9wptbzw)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="87" x="5" y="21.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="32.5" y="41.292">Alice</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="12" y="57.5889">(Proposer)</text><rect fill="#FEFECE" filter="url(#f9m3ai9wptbzw)" height="62.8906" style="stroke:#A80036;stroke-width:1.5;" width="104" x="172.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="205.5" y="24.9951">Ingrid</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="68" x="190.5" y="41.292">(Common</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="179.5" y="57.5889">Intermediary)</text><rect fill="#FEFECE" filter="url(#f9m3ai9wptbzw)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="91" x="355" y="21.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="386.5" y="41.292">Bob</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="362" y="57.5889">(Proposee)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="50.5" x2="92.5" y1="177.6875" y2="177.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="92.5" x2="92.5" y1="177.6875" y2="190.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="51.5" x2="92.5" y1="190.6875" y2="190.6875"/><polygon fill="#A80036" points="61.5,186.6875,51.5,190.6875,61.5,194.6875,57.5,190.6875" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="57.5" y="96.9575">Generate an update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="57.5" y="112.0903">parent ledger channel 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="57.5" y="127.2231">(between alice &amp;ingrid)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="57.5" y="142.356">that locks the funds</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="57.5" y="157.4888">for the virtual channel ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="57.5" y="172.6216">as per opening balance</text><line style="stroke:#A80036;stroke-width:1.0;" x1="402.5" x2="444.5" y1="177.6875" y2="177.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="444.5" x2="444.5" y1="177.6875" y2="190.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403.5" x2="444.5" y1="190.6875" y2="190.6875"/><polygon fill="#A80036" points="413.5,186.6875,403.5,190.6875,413.5,194.6875,409.5,190.6875" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="409.5" y="96.9575">Generate an update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="409.5" y="112.0903">parent ledger channel 2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="409.5" y="127.2231">(between bob &amp;ingrid)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="409.5" y="142.356">that locks the funds</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="409.5" y="157.4888">for the virtual channel ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="409.5" y="172.6216">as per opening balance</text><polygon fill="#A80036" points="214.5,230.9531,224.5,234.9531,214.5,238.9531,218.5,234.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="50.5" x2="220.5" y1="234.9531" y2="234.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="62.5" y="214.7544">Send the update on the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="62.5" y="229.8872">parent ledger channel 1</text><polygon fill="#A80036" points="237.5,275.2188,227.5,279.2188,237.5,283.2188,233.5,279.2188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="231.5" x2="401.5" y1="279.2188" y2="279.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="238.5" y="259.02">Send the update on the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="238.5" y="274.1528">parent ledger channel 2</text><line style="stroke:#0000FF;stroke-width:1.0;" x1="226.5" x2="268.5" y1="323.4844" y2="323.4844"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="268.5" x2="268.5" y1="323.4844" y2="336.4844"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="227.5" x2="268.5" y1="336.4844" y2="336.4844"/><polygon fill="#0000FF" points="237.5,332.4844,227.5,336.4844,237.5,340.4844,233.5,336.4844" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="233.5" y="303.2856">Accept or</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="233.5" y="318.4185">reject</text><path d="M106.5,349.4844 L106.5,389.4844 L342.5,389.4844 L342.5,359.4844 L332.5,349.4844 L106.5,349.4844 " fill="#D3D3D3" filter="url(#f9m3ai9wptbzw)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M332.5,349.4844 L332.5,359.4844 L342.5,359.4844 L332.5,349.4844 " fill="#D3D3D3" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="215" x="112.5" y="366.5513">When rejected, the protocol stops</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="112.5" y="381.6841">here and funding will fail</text><polygon fill="#A80036" points="61.5,431.0156,51.5,435.0156,61.5,439.0156,57.5,435.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="55.5" x2="225.5" y1="435.0156" y2="435.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="69.5" y="414.8169">Accept the update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="62.5" y="429.9497">parent ledger channel 1</text><polygon fill="#A80036" points="390.5,475.2813,400.5,479.2813,390.5,483.2813,394.5,479.2813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="226.5" x2="396.5" y1="479.2813" y2="479.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="245.5" y="459.0825">Accept the update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="238.5" y="474.2153">parent ledger channel 2</text><line style="stroke:#A80036;stroke-width:1.0;" x1="50.5" x2="92.5" y1="508.4141" y2="508.4141"/><line style="stroke:#A80036;stroke-width:1.0;" x1="92.5" x2="92.5" y1="508.4141" y2="521.4141"/><line style="stroke:#A80036;stroke-width:1.0;" x1="51.5" x2="92.5" y1="521.4141" y2="521.4141"/><polygon fill="#A80036" points="61.5,517.4141,51.5,521.4141,61.5,525.4141,57.5,521.4141" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="57.5" y="503.3481">Virtual channel is funded</text><line style="stroke:#A80036;stroke-width:1.0;" x1="402.5" x2="444.5" y1="508.4141" y2="508.4141"/><line style="stroke:#A80036;stroke-width:1.0;" x1="444.5" x2="444.5" y1="508.4141" y2="521.4141"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403.5" x2="444.5" y1="521.4141" y2="521.4141"/><polygon fill="#A80036" points="413.5,517.4141,403.5,521.4141,413.5,525.4141,409.5,521.4141" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="409.5" y="503.3481">Virtual channel is funded</text><rect fill="#DDDDDD" height="58.8906" rx="5" ry="5" style="stroke:#000000;stroke-width:1.0;" width="201" x="363.5" y="547.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="369.5" y="565.4092">Note:</text><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="369.5" y="581.7061">Blue</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="408.5" y="581.7061">arrow indicates</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="189" x="369.5" y="598.0029">user interaction is required.</text><!--MD5=[4ed8a4dbf2b2e473f309cfcf93577aea]
@startuml open_funding_virtual
!pragma teoz true
hide footbox
skinparam SequenceMessageAlign center

participant "Alice\n(Proposer)" as alice
participant "Ingrid\n(Common\nIntermediary)" as ingrid
participant "Bob\n(Proposee)" as bob

alice -> alice: Generate an update on\nparent ledger channel 1\n(between alice &ingrid)\nthat locks the funds\nfor the virtual channel ID\nas per opening balance
&bob -> bob: Generate an update on\nparent ledger channel 2\n(between bob &ingrid)\nthat locks the funds\nfor the virtual channel ID\nas per opening balance

alice -> ingrid: Send the update on the\nparent ledger channel 1
ingrid <- bob: Send the update on the\nparent ledger channel 2

ingrid -[#blue]> ingrid: Accept or\nreject

note over ingrid #LightGray
When rejected, the protocol stops
here and funding will fail
end note

alice <- ingrid: Accept the update on\nparent ledger channel 1
ingrid -> bob: Accept the update on\nparent ledger channel 2


alice -> alice: Virtual channel is funded
&bob -> bob: Virtual channel is funded

legend bottom right
<b>Note:</b>
<color:blue>Blue </color> arrow indicates
user interaction is required.
endlegend

@enduml

PlantUML version 1.2020.21(Mon Nov 30 22:10:11 IST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: IN
--></g></svg>