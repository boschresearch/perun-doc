<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1104px" preserveAspectRatio="none" style="width:730px;height:1104px;" version="1.1" viewBox="0 0 730 1104" width="730px" zoomAndPan="magnify"><defs><filter height="300%" id="f84bhlsikvaqf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f84bhlsikvaqf)" height="434.4688" style="stroke:#000000;stroke-width:2.0;" width="526" x="8" y="246.9531"/><rect fill="#FFFFFF" height="111.2031" style="stroke:none;stroke-width:1.0;" width="526" x="8" y="570.2188"/><rect fill="#FFFFFF" filter="url(#f84bhlsikvaqf)" height="146.3359" style="stroke:#000000;stroke-width:2.0;" width="155" x="255" y="404.8828"/><rect fill="#FFFFFF" height="56.9375" style="stroke:none;stroke-width:1.0;" width="155" x="255" y="494.2813"/><rect fill="#FFFFFF" filter="url(#f84bhlsikvaqf)" height="308.2656" style="stroke:#000000;stroke-width:2.0;" width="635" x="57" y="694.4219"/><rect fill="#FFFFFF" height="145.4688" style="stroke:none;stroke-width:1.0;" width="635" x="57" y="857.2188"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="73" x2="73" y1="72.8906" y2="1021.6875"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="271" x2="271" y1="72.8906" y2="1021.6875"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="478" x2="478" y1="72.8906" y2="1021.6875"/><rect fill="#FEFECE" filter="url(#f84bhlsikvaqf)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="87" x="27.5" y="21.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="55" y="41.292">Alice</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="34.5" y="57.5889">(Proposer)</text><rect fill="#FEFECE" filter="url(#f84bhlsikvaqf)" height="62.8906" style="stroke:#A80036;stroke-width:1.5;" width="104" x="217" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="250" y="24.9951">Ingrid</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="68" x="235" y="41.292">(Common</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="224" y="57.5889">Intermediary)</text><rect fill="#FEFECE" filter="url(#f84bhlsikvaqf)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="91" x="430.5" y="21.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="462" y="41.292">Bob</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="437.5" y="57.5889">(Proposee)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="73" x2="115" y1="177.6875" y2="177.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="115" x2="115" y1="177.6875" y2="190.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="74" x2="115" y1="190.6875" y2="190.6875"/><polygon fill="#A80036" points="84,186.6875,74,190.6875,84,194.6875,80,190.6875" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="80" y="96.9575">Generate an update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="80" y="112.0903">parent ledger channel 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="80" y="127.2231">(between alice &amp;ingrid)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="80" y="142.356">that locks the funds</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="80" y="157.4888">for the virtual channel ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="80" y="172.6216">as per opening balance</text><line style="stroke:#A80036;stroke-width:1.0;" x1="478" x2="520" y1="177.6875" y2="177.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="520" x2="520" y1="177.6875" y2="190.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="479" x2="520" y1="190.6875" y2="190.6875"/><polygon fill="#A80036" points="489,186.6875,479,190.6875,489,194.6875,485,190.6875" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="485" y="96.9575">Generate an update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="485" y="112.0903">parent ledger channel 2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="485" y="127.2231">(between bob &amp;ingrid)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="485" y="142.356">that locks the funds</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="485" y="157.4888">for the virtual channel ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="485" y="172.6216">as per opening balance</text><polygon fill="#A80036" points="259,230.9531,269,234.9531,259,238.9531,263,234.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="73" x2="265" y1="234.9531" y2="234.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="96" y="214.7544">Send the update on the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="96" y="229.8872">parent ledger channel 1</text><path d="M8,246.9531 L78,246.9531 L78,253.9531 L68,263.9531 L8,263.9531 L8,246.9531 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="434.4688" style="stroke:#000000;stroke-width:2.0;" width="526" x="8" y="246.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="23" y="260.02">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="378" x="93" y="259.1636">[when matching update is received withing expected time]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="8" x2="534" y1="571.2188" y2="571.2188"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="13" y="581.4292">[else]</text><polygon fill="#A80036" points="282,316.4844,272,320.4844,282,324.4844,278,320.4844" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="276" x2="477" y1="320.4844" y2="320.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="316" y="285.1528">(Matching update)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="298.5" y="300.2856">Send the update on the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="298.5" y="315.4185">parent ledger channel 2</text><line style="stroke:#A80036;stroke-width:1.0;" x1="271" x2="313" y1="379.8828" y2="379.8828"/><line style="stroke:#A80036;stroke-width:1.0;" x1="313" x2="313" y1="379.8828" y2="392.8828"/><line style="stroke:#A80036;stroke-width:1.0;" x1="272" x2="313" y1="392.8828" y2="392.8828"/><polygon fill="#A80036" points="282,388.8828,272,392.8828,282,396.8828,278,392.8828" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="278" y="344.5513">Validate the two updates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="278" y="359.6841">(Parameters of virtual channel</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="278" y="374.8169">in both must match)</text><path d="M255,404.8828 L325,404.8828 L325,411.8828 L315,421.8828 L255,421.8828 L255,404.8828 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="146.3359" style="stroke:#000000;stroke-width:2.0;" width="155" x="255" y="404.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="270" y="417.9497">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="340" y="417.0933">[if valid]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="255" x2="410" y1="495.2813" y2="495.2813"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="260" y="505.4917">[else]</text><line style="stroke:#0000FF;stroke-width:1.0;" x1="271" x2="313" y1="463.2813" y2="463.2813"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="313" x2="313" y1="463.2813" y2="476.2813"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="272" x2="313" y1="476.2813" y2="476.2813"/><polygon fill="#0000FF" points="282,472.2813,272,476.2813,282,480.2813,278,476.2813" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="278" y="443.0825">Accept or</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="278" y="458.2153">reject</text><line style="stroke:#A80036;stroke-width:1.0;" x1="271" x2="313" y1="530.2188" y2="530.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="313" x2="313" y1="530.2188" y2="543.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="272" x2="313" y1="543.2188" y2="543.2188"/><polygon fill="#A80036" points="282,539.2188,272,543.2188,282,547.2188,278,543.2188" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="278" y="525.1528">Reject</text><line style="stroke:#A80036;stroke-width:1.0;" x1="271" x2="313" y1="606.1563" y2="606.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="313" x2="313" y1="606.1563" y2="619.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="272" x2="313" y1="619.1563" y2="619.1563"/><polygon fill="#A80036" points="282,615.1563,272,619.1563,282,623.1563,278,619.1563" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="278" y="601.0903">Reject</text><path d="M29,632.1563 L29,672.1563 L509,672.1563 L509,642.1563 L499,632.1563 L29,632.1563 " fill="#D3D3D3" filter="url(#f84bhlsikvaqf)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M499,632.1563 L499,642.1563 L509,642.1563 L499,632.1563 " fill="#D3D3D3" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="459" x="35" y="649.2231">For the participant from whom update was received, reject immediately.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="419" x="35" y="664.356">For other participants, reject when a matching update is received.</text><path d="M57,694.4219 L127,694.4219 L127,701.4219 L117,711.4219 L57,711.4219 L57,694.4219 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="308.2656" style="stroke:#000000;stroke-width:2.0;" width="635" x="57" y="694.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="72" y="707.4888">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="66" x="142" y="706.6323">[if accept]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="57" x2="692" y1="858.2188" y2="858.2188"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="62" y="868.4292">[if reject]</text><polygon fill="#A80036" points="84,748.8203,74,752.8203,84,756.8203,80,752.8203" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="78" x2="270" y1="752.8203" y2="752.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="103" y="732.6216">Accept the update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="96" y="747.7544">parent ledger channel 1</text><polygon fill="#A80036" points="466,793.0859,476,797.0859,466,801.0859,470,797.0859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="271" x2="472" y1="797.0859" y2="797.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="305.5" y="776.8872">Accept the update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="298.5" y="792.02">parent ledger channel 2</text><line style="stroke:#A80036;stroke-width:1.0;" x1="73" x2="115" y1="826.2188" y2="826.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="115" x2="115" y1="826.2188" y2="839.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="74" x2="115" y1="839.2188" y2="839.2188"/><polygon fill="#A80036" points="84,835.2188,74,839.2188,84,843.2188,80,839.2188" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="80" y="821.1528">Virtual channel is funded</text><line style="stroke:#A80036;stroke-width:1.0;" x1="478" x2="520" y1="826.2188" y2="826.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="520" x2="520" y1="826.2188" y2="839.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="479" x2="520" y1="839.2188" y2="839.2188"/><polygon fill="#A80036" points="489,835.2188,479,839.2188,489,843.2188,485,839.2188" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="485" y="821.1528">Virtual channel is funded</text><polygon fill="#A80036" points="84,904.2891,74,908.2891,84,912.2891,80,908.2891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="78" x2="270" y1="908.2891" y2="908.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="105.5" y="888.0903">Reject the update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="96" y="903.2231">parent ledger channel 1</text><polygon fill="#A80036" points="466,948.5547,476,952.5547,466,956.5547,470,952.5547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="271" x2="472" y1="952.5547" y2="952.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="308" y="932.356">Reject the update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="298.5" y="947.4888">parent ledger channel 2</text><line style="stroke:#A80036;stroke-width:1.0;" x1="73" x2="115" y1="981.6875" y2="981.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="115" x2="115" y1="981.6875" y2="994.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="74" x2="115" y1="994.6875" y2="994.6875"/><polygon fill="#A80036" points="84,990.6875,74,994.6875,84,998.6875,80,994.6875" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="80" y="976.6216">Virtual channel funding failed</text><line style="stroke:#A80036;stroke-width:1.0;" x1="478" x2="520" y1="981.6875" y2="981.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="520" x2="520" y1="981.6875" y2="994.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="479" x2="520" y1="994.6875" y2="994.6875"/><polygon fill="#A80036" points="489,990.6875,479,994.6875,489,998.6875,485,994.6875" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="485" y="976.6216">Virtual channel funding failed</text><rect fill="#DDDDDD" height="58.8906" rx="5" ry="5" style="stroke:#000000;stroke-width:1.0;" width="201" x="513.5" y="1029.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="519.5" y="1047.6826">Note:</text><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="519.5" y="1063.9795">Blue</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="558.5" y="1063.9795">arrow indicates</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="189" x="519.5" y="1080.2764">user interaction is required.</text><!--MD5=[31c893e46a2e1bcbd8b2f77c91a69deb]
@startuml open_funding_virtual
!pragma teoz true
hide footbox
skinparam SequenceMessageAlign center

participant "Alice\n(Proposer)" as alice
participant "Ingrid\n(Common\nIntermediary)" as ingrid
participant "Bob\n(Proposee)" as bob

alice -> alice: Generate an update on\nparent ledger channel 1\n(between alice &ingrid)\nthat locks the funds\nfor the virtual channel ID\nas per opening balance
&bob -> bob: Generate an update on\nparent ledger channel 2\n(between bob &ingrid)\nthat locks the funds\nfor the virtual channel ID\nas per opening balance

alice -> ingrid: Send the update on the\nparent ledger channel 1

opt when matching update is received withing expected time
ingrid <- bob: (Matching update)\nSend the update on the\nparent ledger channel 2

ingrid -> ingrid: Validate the two updates\n(Parameters of virtual channel\nin both must match)

opt if valid
ingrid -[#blue]> ingrid: Accept or\nreject
else else
ingrid -> ingrid: Reject
end

else else
ingrid -> ingrid: Reject
note over ingrid #LightGray
For the participant from whom update was received, reject immediately.
For other participants, reject when a matching update is received.
end note

end

opt if accept
alice <- ingrid: Accept the update on\nparent ledger channel 1
ingrid -> bob: Accept the update on\nparent ledger channel 2

alice -> alice: Virtual channel is funded
&bob -> bob: Virtual channel is funded
else if reject
alice <- ingrid: Reject the update on\nparent ledger channel 1
ingrid -> bob: Reject the update on\nparent ledger channel 2

alice -> alice: Virtual channel funding failed
&bob -> bob: Virtual channel funding failed
end

legend bottom right
<b>Note:</b>
<color:blue>Blue </color> arrow indicates
user interaction is required.
endlegend

@enduml

PlantUML version 1.2020.21(Mon Nov 30 22:10:11 IST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: IN
--></g></svg>