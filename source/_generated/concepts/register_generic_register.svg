<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="708px" preserveAspectRatio="none" style="width:473px;height:708px;" version="1.1" viewBox="0 0 473 708" width="473px" zoomAndPan="magnify"><defs><filter height="300%" id="fuarbfqklruq9" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fuarbfqklruq9)" height="627.2734" style="stroke:#000000;stroke-width:2.0;" width="449" x="10" y="57.2969"/><rect fill="#FFFFFF" filter="url(#fuarbfqklruq9)" height="203.4766" style="stroke:#000000;stroke-width:2.0;" width="311.5" x="137.5" y="256.3594"/><rect fill="#FFFFFF" filter="url(#fuarbfqklruq9)" height="112.9453" style="stroke:#000000;stroke-width:2.0;" width="273.5" x="147.5" y="339.8906"/><rect fill="#FFFFFF" filter="url(#fuarbfqklruq9)" height="146.4688" style="stroke:#000000;stroke-width:2.0;" width="239" x="147.5" y="531.1016"/><rect fill="#FFFFFF" height="72.0703" style="stroke:none;stroke-width:1.0;" width="239" x="147.5" y="605.5"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="45" x2="45" y1="40.2969" y2="701.5703"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="208.5" x2="208.5" y1="40.2969" y2="701.5703"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="416" x2="416" y1="40.2969" y2="701.5703"/><rect fill="#FEFECE" filter="url(#fuarbfqklruq9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="46" x="20" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="27" y="24.9951">Alice</text><rect fill="#FEFECE" filter="url(#fuarbfqklruq9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="99" x="157.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="164.5" y="24.9951">Parent Layer</text><rect fill="#FEFECE" filter="url(#fuarbfqklruq9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="42" x="393" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="400" y="24.9951">Bob</text><path d="M10,57.2969 L80,57.2969 L80,64.2969 L70,74.2969 L10,74.2969 L10,57.2969 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="627.2734" style="stroke:#000000;stroke-width:2.0;" width="449" x="10" y="57.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="25" y="70.3638">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="259" x="95" y="69.5073">[if latest off-chain state is not finalized]</text><polygon fill="#A80036" points="197,121.8281,207,125.8281,197,129.8281,201,125.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="45" x2="203" y1="125.8281" y2="125.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="82.5" y="90.4966">Register state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="57" y="105.6294">(along with signatures</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="72" y="120.7622">of all participants)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="209" x2="251" y1="170.0938" y2="170.0938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="251" x2="251" y1="170.0938" y2="183.0938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="210" x2="251" y1="183.0938" y2="183.0938"/><polygon fill="#A80036" points="220,179.0938,210,183.0938,220,187.0938,216,183.0938" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="216" y="149.895">Start challenge duration</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="216" y="165.0278">for register</text><polygon fill="#A80036" points="56,208.2266,46,212.2266,56,216.2266,52,212.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="50" x2="208" y1="212.2266" y2="212.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="75" y="207.1606">State registered</text><polygon fill="#A80036" points="404,237.3594,414,241.3594,404,245.3594,408,241.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="209" x2="410" y1="241.3594" y2="241.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="260.5" y="236.2935">State registered</text><path d="M137.5,256.3594 L207.5,256.3594 L207.5,263.3594 L197.5,273.3594 L137.5,273.3594 L137.5,256.3594 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="203.4766" style="stroke:#000000;stroke-width:2.0;" width="311.5" x="137.5" y="256.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="152.5" y="269.4263">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="207" x="222.5" y="268.5698">[if state registered is not latest]</text><polygon fill="#A80036" points="220,320.8906,210,324.8906,220,328.8906,216,324.8906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="214" x2="415" y1="324.8906" y2="324.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="248" y="289.5591">Register latest state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="242.5" y="304.6919">(along with signatures</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="257.5" y="319.8247">of all participants)</text><path d="M147.5,339.8906 L217.5,339.8906 L217.5,346.8906 L207.5,356.8906 L147.5,356.8906 L147.5,339.8906 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="112.9453" style="stroke:#000000;stroke-width:2.0;" width="273.5" x="147.5" y="339.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="162.5" y="352.9575">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="89" x="232.5" y="352.1011">[If bob's state</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="232.5" y="364.9058">is valid</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="232.5" y="377.7104">has higher version.]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="209" x2="251" y1="431.8359" y2="431.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="251" x2="251" y1="431.8359" y2="444.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="210" x2="251" y1="444.8359" y2="444.8359"/><polygon fill="#A80036" points="220,440.8359,210,444.8359,220,448.8359,216,444.8359" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="216" y="396.5044">Update registered state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="216" y="411.6372">and restart challenge duration</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="216" y="426.77">for register</text><line style="stroke:#A80036;stroke-width:1.0;" x1="209" x2="251" y1="503.1016" y2="503.1016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="251" x2="251" y1="503.1016" y2="516.1016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="210" x2="251" y1="516.1016" y2="516.1016"/><polygon fill="#A80036" points="220,512.1016,210,516.1016,220,520.1016,216,516.1016" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="216" y="482.9028">Wait for challenge duration</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="216" y="498.0356">for register to expire</text><path d="M147.5,531.1016 L217.5,531.1016 L217.5,538.1016 L207.5,548.1016 L147.5,548.1016 L147.5,531.1016 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="146.4688" style="stroke:#000000;stroke-width:2.0;" width="239" x="147.5" y="531.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="162.5" y="544.1685">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="149" x="232.5" y="543.312">[if channel has an app]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="209" x2="251" y1="584.5" y2="584.5"/><line style="stroke:#A80036;stroke-width:1.0;" x1="251" x2="251" y1="584.5" y2="597.5"/><line style="stroke:#A80036;stroke-width:1.0;" x1="210" x2="251" y1="597.5" y2="597.5"/><polygon fill="#A80036" points="220,593.5,210,597.5,220,601.5,216,597.5" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="216" y="564.3013">Start challenge duration</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="216" y="579.4341">for on-chain progression</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="147.5" x2="386.5" y1="606.5" y2="606.5"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="217" x="152.5" y="616.7104">[if channel does not have an app]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="209" x2="251" y1="656.5703" y2="656.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="251" x2="251" y1="656.5703" y2="669.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="210" x2="251" y1="669.5703" y2="669.5703"/><polygon fill="#A80036" points="220,665.5703,210,669.5703,220,673.5703,216,669.5703" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="216" y="636.3716">Channel finalized</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="216" y="651.5044">on-chain</text><!--MD5=[aefc6fa6ff06b61957ef5fa373873c3b]
@startuml register_generic_register
hide footbox
skinparam SequenceMessageAlign center

participant "Alice" as alice
participant "Parent Layer" as parentLayer
participant "Bob" as bob


opt if latest off-chain state is not finalized
alice -> parentLayer: Register state\n(along with signatures\n of all participants)
parentLayer -> parentLayer: Start challenge duration\nfor register
alice <- parentLayer: State registered
parentLayer -> bob: State registered
opt if state registered is not latest
parentLayer <- bob: Register latest state\n(along with signatures\n of all participants)
opt If bob's state\nis valid\nhas higher version.
parentLayer -> parentLayer: Update registered state\nand restart challenge duration\nfor register
end
end
parentLayer -> parentLayer: Wait for challenge duration\nfor register to expire
opt if channel has an app
parentLayer -> parentLayer: Start challenge duration\nfor on-chain progression
else if channel does not have an app
parentLayer -> parentLayer: Channel finalized\non-chain 
end
end

@enduml

PlantUML version 1.2020.21(Mon Nov 30 22:10:11 IST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>