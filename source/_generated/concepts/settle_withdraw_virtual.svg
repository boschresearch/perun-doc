<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="542px" preserveAspectRatio="none" style="width:602px;height:542px;" version="1.1" viewBox="0 0 602 542" width="602px" zoomAndPan="magnify"><defs><filter height="300%" id="fx5yt2lzxm5kh" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fx5yt2lzxm5kh)" height="431.5234" style="stroke:#000000;stroke-width:2.0;" width="554" x="34.5" y="84.8906"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="50.5" x2="50.5" y1="72.8906" y2="535.4141"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="226.5" x2="226.5" y1="72.8906" y2="535.4141"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="402.5" x2="402.5" y1="72.8906" y2="535.4141"/><rect fill="#FEFECE" filter="url(#fx5yt2lzxm5kh)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="87" x="5" y="21.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="32.5" y="41.292">Alice</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="12" y="57.5889">(Proposer)</text><rect fill="#FEFECE" filter="url(#fx5yt2lzxm5kh)" height="62.8906" style="stroke:#A80036;stroke-width:1.5;" width="104" x="172.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="205.5" y="24.9951">Ingrid</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="68" x="190.5" y="41.292">(Common</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="179.5" y="57.5889">Intermediary)</text><rect fill="#FEFECE" filter="url(#fx5yt2lzxm5kh)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="91" x="355" y="21.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="386.5" y="41.292">Bob</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="362" y="57.5889">(Proposee)</text><path d="M34.5,84.8906 L104.5,84.8906 L104.5,91.8906 L94.5,101.8906 L34.5,101.8906 L34.5,84.8906 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="431.5234" style="stroke:#000000;stroke-width:2.0;" width="554" x="34.5" y="84.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="49.5" y="97.9575">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="234" x="119.5" y="97.1011">[if latest off-chain state is finalized]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="50.5" x2="92.5" y1="203.8203" y2="203.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="92.5" x2="92.5" y1="203.8203" y2="216.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="51.5" x2="92.5" y1="216.8203" y2="216.8203"/><polygon fill="#A80036" points="61.5,212.8203,51.5,216.8203,61.5,220.8203,57.5,216.8203" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="57.5" y="123.0903">Generate an update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="57.5" y="138.2231">parent ledger channel 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="57.5" y="153.356">(between alice &amp;ingrid)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="57.5" y="168.4888">that unlocks the funds</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="57.5" y="183.6216">for the virtual channel ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="57.5" y="198.7544">as per final balance</text><line style="stroke:#A80036;stroke-width:1.0;" x1="402.5" x2="444.5" y1="203.8203" y2="203.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="444.5" x2="444.5" y1="203.8203" y2="216.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403.5" x2="444.5" y1="216.8203" y2="216.8203"/><polygon fill="#A80036" points="413.5,212.8203,403.5,216.8203,413.5,220.8203,409.5,216.8203" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="409.5" y="123.0903">Generate an update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="409.5" y="138.2231">parent ledger channel 2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="409.5" y="153.356">(between bob &amp;ingrid)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="409.5" y="168.4888">that unlocks the funds</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="409.5" y="183.6216">for the virtual channel ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="409.5" y="198.7544">as per final balance</text><polygon fill="#A80036" points="214.5,257.0859,224.5,261.0859,214.5,265.0859,218.5,261.0859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="50.5" x2="220.5" y1="261.0859" y2="261.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="62.5" y="240.8872">Send the update on the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="62.5" y="256.02">parent ledger channel 1</text><polygon fill="#A80036" points="61.5,301.3516,51.5,305.3516,61.5,309.3516,57.5,305.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="55.5" x2="225.5" y1="305.3516" y2="305.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="69.5" y="285.1528">Accept the update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="62.5" y="300.2856">parent ledger channel 1</text><line style="stroke:#A80036;stroke-width:1.0;" x1="50.5" x2="92.5" y1="349.6172" y2="349.6172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="92.5" x2="92.5" y1="349.6172" y2="362.6172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="51.5" x2="92.5" y1="362.6172" y2="362.6172"/><polygon fill="#A80036" points="61.5,358.6172,51.5,362.6172,61.5,366.6172,57.5,362.6172" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="57.5" y="329.4185">Virtual channel is</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="57.5" y="344.5513">withdrawn for alice</text><polygon fill="#A80036" points="237.5,402.8828,227.5,406.8828,237.5,410.8828,233.5,406.8828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="231.5" x2="401.5" y1="406.8828" y2="406.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="238.5" y="386.6841">Send the update on the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="238.5" y="401.8169">parent ledger channel 2</text><polygon fill="#A80036" points="390.5,447.1484,400.5,451.1484,390.5,455.1484,394.5,451.1484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="226.5" x2="396.5" y1="451.1484" y2="451.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="245.5" y="430.9497">Accept the update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="238.5" y="446.0825">parent ledger channel 2</text><line style="stroke:#A80036;stroke-width:1.0;" x1="402.5" x2="444.5" y1="495.4141" y2="495.4141"/><line style="stroke:#A80036;stroke-width:1.0;" x1="444.5" x2="444.5" y1="495.4141" y2="508.4141"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403.5" x2="444.5" y1="508.4141" y2="508.4141"/><polygon fill="#A80036" points="413.5,504.4141,403.5,508.4141,413.5,512.4141,409.5,508.4141" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="409.5" y="475.2153">Virtual channel is</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="409.5" y="490.3481">withdrawn for bob</text><!--MD5=[26e1b30ccb5d0147f309bd259e3c7d59]
@startuml settle_withdraw_virtual
!pragma teoz true
hide footbox
skinparam SequenceMessageAlign center

participant "Alice\n(Proposer)" as alice
participant "Ingrid\n(Common\nIntermediary)" as ingrid
participant "Bob\n(Proposee)" as bob

opt if latest off-chain state is finalized
alice -> alice: Generate an update on\nparent ledger channel 1\n(between alice &ingrid)\nthat unlocks the funds\nfor the virtual channel ID\nas per final balance
&bob -> bob: Generate an update on\nparent ledger channel 2\n(between bob &ingrid)\nthat unlocks the funds\nfor the virtual channel ID\nas per final balance

alice -> ingrid: Send the update on the\nparent ledger channel 1
alice <- ingrid: Accept the update on\nparent ledger channel 1
alice -> alice: Virtual channel is\nwithdrawn for alice

ingrid <- bob: Send the update on the\nparent ledger channel 2
ingrid -> bob: Accept the update on\nparent ledger channel 2
bob -> bob: Virtual channel is\nwithdrawn for bob
end

@enduml

PlantUML version 1.2020.21(Mon Nov 30 22:10:11 IST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: IN
--></g></svg>