<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="885px" preserveAspectRatio="none" style="width:433px;height:885px;" version="1.1" viewBox="0 0 433 885" width="433px" zoomAndPan="magnify"><defs><filter height="300%" id="fhgo0n02znwj2" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fhgo0n02znwj2)" height="51.2656" style="stroke:#000000;stroke-width:2.0;" width="257" x="23.5" y="364.7578"/><rect fill="#FFFFFF" filter="url(#fhgo0n02znwj2)" height="277" style="stroke:#000000;stroke-width:2.0;" width="384" x="23.5" y="429.0234"/><rect fill="#FFFFFF" height="43.9375" style="stroke:none;stroke-width:1.0;" width="384" x="23.5" y="662.0859"/><rect fill="#FFFFFF" filter="url(#fhgo0n02znwj2)" height="64.2656" style="stroke:#000000;stroke-width:2.0;" width="253" x="23.5" y="719.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="39.5" x2="39.5" y1="40.2969" y2="802.2891"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="244.5" x2="244.5" y1="40.2969" y2="802.2891"/><rect fill="#FEFECE" filter="url(#fhgo0n02znwj2)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="46" x="14.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="21.5" y="24.9951">Alice</text><rect fill="#FEFECE" filter="url(#fhgo0n02znwj2)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="42" x="221.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="228.5" y="24.9951">Bob</text><line style="stroke:#0000FF;stroke-width:1.0;" x1="39.5" x2="81.5" y1="69.4297" y2="69.4297"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="81.5" x2="81.5" y1="69.4297" y2="82.4297"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="40.5" x2="81.5" y1="82.4297" y2="82.4297"/><polygon fill="#0000FF" points="50.5,78.4297,40.5,82.4297,50.5,86.4297,46.5,82.4297" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="46.5" y="64.3638">User proposes update</text><line style="stroke:#A80036;stroke-width:1.0;" x1="39.5" x2="81.5" y1="141.8281" y2="141.8281"/><line style="stroke:#A80036;stroke-width:1.0;" x1="81.5" x2="81.5" y1="141.8281" y2="154.8281"/><line style="stroke:#A80036;stroke-width:1.0;" x1="40.5" x2="81.5" y1="154.8281" y2="154.8281"/><polygon fill="#A80036" points="50.5,150.8281,40.5,154.8281,50.5,158.8281,46.5,154.8281" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="46.5" y="106.4966">Generate an updated state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="46.5" y="121.6294">(modify balances and/or data;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="46.5" y="136.7622">increment version)</text><path d="M10,167.8281 L10,207.8281 L270,207.8281 L270,177.8281 L260,167.8281 L10,167.8281 " fill="#D3D3D3" filter="url(#fhgo0n02znwj2)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M260,167.8281 L260,177.8281 L270,177.8281 L260,167.8281 " fill="#D3D3D3" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="16" y="184.895">If this is the last off-chain transaction,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="217" x="16" y="200.0278">"isFinal" flag should be set to true.</text><line style="stroke:#A80036;stroke-width:1.0;" x1="39.5" x2="81.5" y1="238.2266" y2="238.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="81.5" x2="81.5" y1="238.2266" y2="251.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="40.5" x2="81.5" y1="251.2266" y2="251.2266"/><polygon fill="#A80036" points="50.5,247.2266,40.5,251.2266,50.5,255.2266,46.5,251.2266" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="46.5" y="233.1606">Sign updated state.</text><polygon fill="#A80036" points="232.5,291.4922,242.5,295.4922,232.5,299.4922,236.5,295.4922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="39.5" x2="238.5" y1="295.4922" y2="295.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="81.5" y="275.2935">Updated state with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="93.5" y="290.4263">alice signature.</text><line style="stroke:#0000FF;stroke-width:1.0;" x1="244.5" x2="286.5" y1="339.7578" y2="339.7578"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="286.5" x2="286.5" y1="339.7578" y2="352.7578"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="245.5" x2="286.5" y1="352.7578" y2="352.7578"/><polygon fill="#0000FF" points="255.5,348.7578,245.5,352.7578,255.5,356.7578,251.5,352.7578" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="251.5" y="319.5591">User chooses to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="251.5" y="334.6919">accept/reject</text><path d="M23.5,364.7578 L93.5,364.7578 L93.5,371.7578 L83.5,381.7578 L23.5,381.7578 L23.5,364.7578 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="51.2656" style="stroke:#000000;stroke-width:2.0;" width="257" x="23.5" y="364.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="38.5" y="377.8247">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="156" x="108.5" y="376.9683">[if user did not respond]</text><polygon fill="#A80036" points="50.5,404.0234,40.5,408.0234,50.5,412.0234,46.5,408.0234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="44.5" x2="243.5" y1="408.0234" y2="408.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="122.5" y="402.9575">Reject</text><path d="M23.5,429.0234 L93.5,429.0234 L93.5,436.0234 L83.5,446.0234 L23.5,446.0234 L23.5,429.0234 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="277" style="stroke:#000000;stroke-width:2.0;" width="384" x="23.5" y="429.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="38.5" y="442.0903">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="66" x="108.5" y="441.2339">[if accept]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="23.5" x2="407.5" y1="663.0859" y2="663.0859"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="28.5" y="673.2964">[if reject]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="244.5" x2="286.5" y1="472.2891" y2="472.2891"/><line style="stroke:#A80036;stroke-width:1.0;" x1="286.5" x2="286.5" y1="472.2891" y2="485.2891"/><line style="stroke:#A80036;stroke-width:1.0;" x1="245.5" x2="286.5" y1="485.2891" y2="485.2891"/><polygon fill="#A80036" points="255.5,481.2891,245.5,485.2891,255.5,489.2891,251.5,485.2891" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="251.5" y="467.2231">Sign updated state</text><line style="stroke:#A80036;stroke-width:1.0;" x1="244.5" x2="286.5" y1="529.5547" y2="529.5547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="286.5" x2="286.5" y1="529.5547" y2="542.5547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="245.5" x2="286.5" y1="542.5547" y2="542.5547"/><polygon fill="#A80036" points="255.5,538.5547,245.5,542.5547,255.5,546.5547,251.5,542.5547" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="251.5" y="509.356">Store updated state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="251.5" y="524.4888">with all signatures.</text><polygon fill="#A80036" points="50.5,582.8203,40.5,586.8203,50.5,590.8203,46.5,586.8203" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="44.5" x2="243.5" y1="586.8203" y2="586.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="97.5" y="566.6216">Bob signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="66.5" y="581.7544">over the updated state.</text><line style="stroke:#A80036;stroke-width:1.0;" x1="39.5" x2="81.5" y1="631.0859" y2="631.0859"/><line style="stroke:#A80036;stroke-width:1.0;" x1="81.5" x2="81.5" y1="631.0859" y2="644.0859"/><line style="stroke:#A80036;stroke-width:1.0;" x1="40.5" x2="81.5" y1="644.0859" y2="644.0859"/><polygon fill="#A80036" points="50.5,640.0859,40.5,644.0859,50.5,648.0859,46.5,644.0859" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="46.5" y="610.8872">Store updated state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="46.5" y="626.02">with all signatures.</text><polygon fill="#A80036" points="50.5,694.0234,40.5,698.0234,50.5,702.0234,46.5,698.0234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="44.5" x2="243.5" y1="698.0234" y2="698.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="122.5" y="692.9575">Reject</text><path d="M23.5,719.0234 L93.5,719.0234 L93.5,726.0234 L83.5,736.0234 L23.5,736.0234 L23.5,719.0234 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="64.2656" style="stroke:#000000;stroke-width:2.0;" width="253" x="23.5" y="719.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="38.5" y="732.0903">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="108.5" y="731.2339">[if bob did not respond]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="39.5" x2="81.5" y1="762.2891" y2="762.2891"/><line style="stroke:#A80036;stroke-width:1.0;" x1="81.5" x2="81.5" y1="762.2891" y2="775.2891"/><line style="stroke:#A80036;stroke-width:1.0;" x1="40.5" x2="81.5" y1="775.2891" y2="775.2891"/><polygon fill="#A80036" points="50.5,771.2891,40.5,775.2891,50.5,779.2891,46.5,775.2891" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="46.5" y="757.2231">Treat as rejected</text><rect fill="#DDDDDD" height="58.8906" rx="5" ry="5" style="stroke:#000000;stroke-width:1.0;" width="201" x="216" y="810.2891"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="222" y="828.2842">Note:</text><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="222" y="844.5811">Blue</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="261" y="844.5811">arrow indicates</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="189" x="222" y="860.8779">user interaction is required.</text><!--MD5=[2d8c6ddc8c435d4d62a560637333ae97]
@startuml transact_generic
!pragma teoz true
hide footbox
skinparam SequenceMessageAlign center

participant "Alice" as alice
participant "Bob" as bob

alice -[#blue]> alice: User proposes update
alice -> alice: Generate an updated state\n(modify balances and/or data;\nincrement version)
note over alice, bob #LightGray
If this is the last off-chain transaction,
"isFinal" flag should be set to true.
endnote
alice -> alice: Sign updated state.
alice -> bob: Updated state with\nalice signature.
bob -[#blue]> bob: User chooses to\naccept/reject
opt if user did not respond
alice <- bob: Reject
end
opt if accept 
bob -> bob: Sign updated state
bob -> bob: Store updated state \nwith all signatures.
alice <- bob: Bob signature\nover the updated state.
alice -> alice: Store updated state \nwith all signatures.
else if reject
alice <- bob: Reject
end
opt if bob did not respond
alice -> alice: Treat as rejected
end

legend bottom right
<b>Note:</b>
<color:blue>Blue </color> arrow indicates
user interaction is required.
endlegend

@enduml

PlantUML version 1.2020.21(Mon Nov 30 22:10:11 IST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: IN
--></g></svg>